<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="es">
<head>
    <meta charset="UTF-8">
    <title>Panel del Técnico</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/tecnico.css}">
</head>
<body class="bg-light">

<!-- Barra superior -->
<nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    <div class="container-fluid">
        <span class="navbar-brand">
            <i class="bi bi-person-badge-fill me-2"></i> Panel Técnico
        </span>
        <div class="d-flex align-items-center text-white">
            <span class="me-3 fw-bold" th:text="${tecnico.nombre}">Nombre Técnico</span>
            <a href="/logout" class="btn btn-sm btn-outline-light">Cerrar sesión</a>
        </div>
    </div>
</nav>

<div class="container-fluid mt-4">

    <!-- Filtros / Tarjetas resumen en una sola sección -->
    <div class="row mb-3 g-3 justify-content-center">
        <div class="col-md-2 mx-1">
            <button class="card text-white bg-primary shadow-sm w-100" onclick="filtrarPorEstado('recibido')">
                <div class="card-body text-center">
                    <h6>Pendientes</h6>
                    <p class="display-6" id="count-pendientes">0</p>
                </div>
            </button>
        </div>
        <div class="col-md-2 mx-1">
            <button class="card text-dark bg-warning shadow-sm w-100" onclick="filtrarPorEstado('en proceso')">
                <div class="card-body text-center">
                    <h6>En proceso</h6>
                    <p class="display-6" id="count-proceso">0</p>
                </div>
            </button>
        </div>
        <div class="col-md-2 mx-1">
            <button class="card text-white bg-success shadow-sm w-100" onclick="filtrarPorEstado('resuelto')">
                <div class="card-body text-center">
                    <h6>Resueltos</h6>
                    <p class="display-6" id="count-finalizados">0</p>
                </div>
            </button>
        </div>
        <div class="col-md-2 mx-1">
            <button class="card text-white bg-secondary shadow-sm w-100" onclick="filtrarPorEstado('cerrado')">
                <div class="card-body text-center">
                    <h6>Cerrados</h6>
                </div>
            </button>
        </div>
    </div>

    <div class="row">

        <!-- Columna de reportes con scroll interno -->
        <div class="col-md-4" id="contenedor-reportes" style="height: calc(100vh - 220px); overflow-y: auto;">
            <!-- Aquí el JS insertará las tarjetas dinámicamente -->
        </div>
        <!-- Columna del mapa con tamaño controlado -->
        <div class="col-md-8">
            <div class="border rounded shadow-sm p-2" style="height: calc(100vh - 220px);">
            <div id="mapa" style="height: 100%;">[Aquí se cargará el mapa]</div>
            </div>
        </div>
    </div>
</div>

<!-- Scripts -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script th:src="@{/js/tecnico-panel.js}"></script>
<script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA_1FjZtRLFk0h9dLAqUopMOi4FJn8t57s&callback=initMap">
</script>
<!-- Modal de imagen -->
<div class="modal fade" id="modalImagen" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
            <div class="modal-body text-center">

                <div id="contenedorImagenZoom" style="overflow: hidden; max-height: 70vh; display: inline-block;">
                    <img id="imagenModalAmpliada" src="" alt="Ampliada" class="img-fluid" style="transition: transform 0.3s;">
                </div>

            </div>
        </div>
    </div>
</div>

</body>
</html>
